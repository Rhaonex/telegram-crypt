<!doctype html>
 
<!-- /media/mint/PR_480_INFORMA/INFORMATICA/LINUX_COMPART/1_LINUX_MINT/BASH/TELEGRAM_CRIPTO_CEL/INDEX.HTML -->

<html lang="pt-BR">

<head>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mensagem Criptada - Enviar/Receber</title>
  <!-- link rel='icon' type='image' href='/media/mint/PR_256_PESSOAL/ECONOMIA/ACOES/PROGRAMAS/PHP/ATU/MODULOS/MENU/IMA/TELEGRAM.PNG' -->
  <link rel="icon" type="image/png" href="data:image/png;base64,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">

  <style>

    :root{
      --bg: #070721; /* fundo geral */
      --fg: #006BC5; /* texto geral */
      --box-bg: #0000FF; /* fundo caixa mensagem */
      --box-fg: #AAAAAA; /* texto caixa mensagem */
      --card-radius: 10px;
      --gap: 12px;
      --border-sender: #A80000;
      --border-dest: #00A800;
    }

    .h1-enc {
      color:#A80000;
      text-align:center;
      width:100%;
    }

    .h1-dec {
      color:#00A800;
      text-align:center;
      width:100%;
    }

    html,body{
      user-select:none;
      oncontextmenu="return false";
      height:100%;
      margin:0;
      font-family:Arial,Helvetica,sans-serif;
      background:var(--bg);
      color:var(--fg);
      scroll-behavior:smooth;
    }

    .wrap{max-width:900px;margin:24px auto;padding:20px}
    h1{font-size:20px;margin:0 0 12px}
    .card{background:rgba(255,255,255,0.02);border-radius:var(--card-radius);padding:16px;margin-bottom:16px}
    label{display:block;margin-bottom:6px}
    input[type="text"],textarea,input[type="password"]{width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);box-sizing:border-box;background:transparent;color:var(--fg)}
    textarea{min-height:120px;color:var(--box-fg);background:var(--box-bg);padding:10px}
    .row{display:flex;gap:var(--gap);align-items:center}
    .half{flex:1}
    button{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;background:var(--fg);color:var(--bg)}
    .muted{opacity:0.8;font-size:13px}
    .small{font-size:13px}
    .actions{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}

    .output{

      background:#07122a;
      color:#cfefff;
      padding:10px;
      border-radius:6px;

      min-height:120px;
      max-height:120px;

      overflow-y:auto;
      overflow-x:hidden;

      white-space:pre-wrap;
      word-break:break-all;

      border:2px solid #0000FF;

    }

    .hint{font-size:12px;color:#9ac8ff}
    .flex-between{display:flex;justify-content:space-between;align-items:center}

    .menu {
      position:sticky;
      top:0;
      background:#070721;
      padding:10px;
      border-radius:10px;
      margin-bottom:16px;
      display:flex;
      gap:10px;
      z-index:1000;
      box-shadow:0 2px 0 #070721;
    }

    .menu button {
      background:#000088;
      color:#9ac8ff;
    }

    .anchor {
      scroll-margin-top:90px
    }

    #passEncrypt,
    #passDecrypt{
      border:2px solid #AA00AA;
      outline:none;
      box-shadow:none;
      border-radius:6px;
    }

    .card-remetente{
      border:3px solid #A80000;
      border-radius:10px;
    }

    .card-destinatario{
      border:3px solid #00A800;
      border-radius:10px;
    }

    .RHAONE {
      color:#AAAAAA;
      background:#070721;
      text-align:center;
      font-size: 10px;
     }

    #sec-enc{
      scroll-margin-top:-30px;
    }

    #sec-dec{
      scroll-margin-top:-80px;
    }

    .TEXTO_PADRAO {
      display:block;
      margin-left:8px;
    }

    @keyframes piscaSenha {
      0%   { background:#000088; color:#AAAAAA; }
      50%  { background:#880000; color:#FFFF00; }
      100% { background:#000088; color:#AAAAAA; }
    }

    .piscar {
      animation: piscaSenha 0.6s linear infinite;
    }

    /* CSS - SUBSTITUA O TEU BLOCO #popup_msg_errado POR ESTE */
    #popup_msg_errado{
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:#700000;
      color:#C8A000;
      border:3px solid #E00038;
      padding:10px 18px;
      border-radius:10px;
      font-weight:bold;
      text-align:center;
      display:none;
      z-index:2147483647;
      pointer-events:auto;
      opacity:0;
      transition:opacity 220ms ease;
      max-width:90%;
      box-sizing:border-box;
    }

    #popup_msg_certo {                  
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:#003800;
      background:#000077;
      color:#C87800;
      color:#C8A000;
      border:3px solid #E000E0;
      border:3px solid #E00038;
      border:3px solid #00FF38;
      border:3px solid #0000FF;
      padding:10px 18px;
      border-radius:10px;
      font-weight:bold;
      text-align:center;
      display:none;
      z-index:2147483647;
      pointer-events:auto;
      opacity:0;
      transition:opacity 220ms ease;
      max-width:90%;
      box-sizing:border-box;
    }

  </style>

</head>

<body>

<div id="popup_msg_errado"></div>
<div id="popup_msg_certo"></div>

  <div class="wrap">

    <div class="menu" style="display:flex;justify-content:center;gap:12px;margin-top:12px">
      <button style="background:#000088;color:#FF0000;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px"
              onclick="scrollAdjEnc()">IR PRA CRIPT</button>
      <button style="background:#000088;color:#00FF00;font-weight:bold;text-shadow:0 0 6px #004000;border:3px solid #0000FF;border-radius:8px"
              onclick="scrollAdjDec()">IR PRA DECRIPT</button>
    </div>

    <h1 class="h1-enc">CRIPT MENSAGEM</h1>

    <div id="sec-enc-scroll" style="position:relative;top:-10px;height:1px;"></div>
    <div id="sec-enc" class="card anchor card-remetente">

      <label for="plain" class="TEXTO_PADRAO">
        MENSAGEM PRA SER CRIPTADA
      </label>

      <textarea id="plain" style="background:#000088;color:#AAAAAA;border:3px solid #0000FF; placeholder="Digite a mensagem aqui..."></textarea>

      <div class="row" style="margin-top:8px">
        <div class="half">
          <div style="display:flex;align-items:center;gap:8px">
            <label for="passEncrypt" style="margin-bottom:0;margin-left:8px;">SENHA</label>
            <label class="small" style="display:flex;align-items:center;gap:4px;margin-bottom:0">
            <input id="passEncrypt" type="text" placeholder="senha pra cript">
            <input id="toggleShowEnc" type="checkbox" style="margin-left:12px;">OCULTAR</label>
          </div>
        </div>
      </div>

      <div class="actions">
        <button id="btnEncrypt"     style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')">CRIPT</button>
        <button id="btnCopyEnc"     style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')">COPIAR</button>
        <button id="btnDownloadEnc" style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')">BAIXAR</button>
      </div>

      <div style="margin-top:16px;margin-bottom:10px;display:flex;align-items:center;gap:24px">
        <span class="TEXTO_PADRAO">
          TEXTO CRIPTADO
        </span>
      </div>

      <div id="encOut" class="output"></div>

    </div>

    <h1 class="h1-dec">DECRIPT MENSAGEM</h1>

    <div id="sec-dec-scroll" style="position:relative;top:-10px;height:1px;"></div>
    <div id="sec-dec" class="card anchor card-destinatario">

      <label for="cipherIn" class="TEXTO_PADRAO">
        COLE AQUI A MENS CRIPTADA
      </label>

      <textarea id="cipherIn" style="background:#000088;color:#AAAAAA;border:3px solid #0000FF; placeholder="cole aqui o conteudo recebido ..."></textarea>

      <div class="row" style="margin-top:8px">
        <div class="half">
          <div style="display:flex;align-items:center;gap:8px">
            <label for="passDecrypt" style="margin-bottom:0">SENHA</label>
            <label class="small" style="display:flex;align-items:center;gap:4px;margin-bottom:0">
            <input id="passDecrypt" type="text" placeholder="senha pra decript">
            <input id="toggleShowEnc" type="checkbox"> OCULTAR </label>
          </div>
        </div>
      </div>

      <div class="actions">
        <button id="btnDecrypt"   style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')">DECRIP</button>
        <button id="btnCopyDec"   style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')" disabled>COPIAR</button>
        <button id="btnReEncrypt" style="background:#000077;color:#006BC5;font-weight:bold;text-shadow:0 0 6px #400000;border:3px solid #0000FF;border-radius:8px" onclick="scrollToSection('sec-enc')" disabled>RECRIP</button>
      </div>

      <div style="margin-top:16px;margin-bottom:10px;display:flex;align-items:center;gap:24px">
        <span style="font-size:16px;color:#006BC5;">
          TEXTO DECRIPTADO
        </span>
      </div>
      <div id="decOut" class="output"></div>

    </div>

    <!-- BOTAO LIMPAR CAMPOS -->
    <div style="text-align:center;margin-top:30px;margin-bottom:40px;">
      <button onclick="clearAllFields()" style="
        background:#000077;
        color:#006BC5;
        border:3px solid #0000FF;
        border-radius:8px;
        padding:10px 20px;
        font-weight:bold;
        text-shadow:0 0 6px #400000;
      ">
        LIMPAR CAMPOS
      </button>
    </div>

    <div class="RHAONE">
       RHAONE MOAJ - 2025-12-12_074012
      <br>

      <span style="font-size:10px;color:#CCCC00;">
        <br>COPIAR E COLAR NO 'TELEGRAM' OU 'WHATSAPP' EXATAMENTE COMO ESTA
      </span>

      <div style="margin-top:14px;">
        CRIPT = AES-GCM + PBKDF2 + BASE64URL
      </div>

    </div>

  </div>

  <script>

    function scrollToSection (id) {
      document.getElementById(id).scrollIntoView({behavior:'smooth'});
    }

    function toBase64(buf){return btoa(String.fromCharCode.apply(null,new Uint8Array(buf)));}
    function fromBase64(str){const clean=str.replace(/[^A-Za-z0-9+/=]/g,'');const bin=atob(clean);const len=bin.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++){bytes[i]=bin.charCodeAt(i);}return bytes.buffer;}

    async function deriveKey(password,salt){const enc=new TextEncoder();const pwKey=await crypto.subtle.importKey('raw',enc.encode(password),{name:'PBKDF2'},false,['deriveKey']);return crypto.subtle.deriveKey({name:'PBKDF2',salt,iterations:200000,hash:'SHA-256'},pwKey,{name:'AES-GCM',length:256},false,['encrypt','decrypt']);}
    async function encryptText(plain,password){const enc=new TextEncoder();const salt=crypto.getRandomValues(new Uint8Array(16));const iv=crypto.getRandomValues(new Uint8Array(12));const key=await deriveKey(password,salt);const ct=await crypto.subtle.encrypt({name:'AES-GCM',iv},key,enc.encode(plain));const combined=new Uint8Array(salt.byteLength+iv.byteLength+ct.byteLength);combined.set(salt,0);combined.set(iv,16);combined.set(new Uint8Array(ct),28);return toBase64(combined.buffer);}
    async function decryptText(b64,password){const buf=fromBase64(b64);const data=new Uint8Array(buf);const salt=data.slice(0,16);const iv=data.slice(16,28);const ct=data.slice(28);const key=await deriveKey(password,salt);const plainBuf=await crypto.subtle.decrypt({name:'AES-GCM',iv},key,ct);return new TextDecoder().decode(plainBuf);}

    /* HOOKS */
    const plainEl   = document.getElementById('plain');
    const passEncEl = document.getElementById('passEncrypt');
    const passDecEl = document.getElementById('passDecrypt');
    const encOutEl  = document.getElementById('encOut');
    const decOutEl  = document.getElementById('decOut');

    const toggleEnc = document.getElementById('toggleShowEnc');
    const toggleDec = document.getElementById('toggleShowDec');
    if(toggleEnc) toggleEnc.addEventListener('change',()=>{ passEncEl.type = toggleEnc.checked ? 'text':'password'; });
    if(toggleDec) toggleDec.addEventListener('change',()=>{ passDecEl.type = toggleDec.checked ? 'text':'password'; });

    document.getElementById('btnEncrypt').addEventListener('click', async ()=>{

      try {

        if (!plainEl.value){ 
          popup_errado ('FALTOU A MENSAGEM PRA CRIPT'); 
          return; 
        }

        if (!passEncEl.value) { 
          popup_errado ('FALTOU A SENHA'); 
          return; 
        }

        const btn = document.getElementById('btnEncrypt');
        btn.disabled = true; btn.textContent = 'PROCESSANDO...';
        const out = await encryptText(plainEl.value, passEncEl.value);
        encOutEl.textContent = out;
        document.getElementById('btnDownloadEnc').disabled = false;
        document.getElementById('btnCopyEnc').disabled = false;
      }catch(err){
        console.error('ERRO ENCRYPT', err);
        popup_errado ('ERRO AO CRIPTAR: ' + (err && err.message));
      }finally{
        const btn = document.getElementById('btnEncrypt');
        btn.disabled = false; btn.textContent = 'CRIPTAR';
      }
    });

    document.getElementById('btnDownloadEnc').addEventListener('click', ()=>{
      const data = encOutEl.textContent || '';
      const blob = new Blob([data], {type: 'text/plain;charset=utf-8'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'MENSAGEM_CRIPTADA.TXT'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(a.href);
    });

  // --- INI - BOTAO COPIAR SAIDA CRIPT (SEGURANCA: CHECA SE ELEMENTOS EXISTEM)
    <!-- document.getElementById('btnCopyEnc').addEventListener('click', ()=> navigator.clipboard.writeText(encOutEl.textContent).then(()=>popup_certo ('TEXTO COPIADO'), ()=>popup_errado ('FALHA AO COPIAR'))); -->

    const btnCopyEnc = document.getElementById('btnCopyEnc');

    if(btnCopyEnc && encOutEl){
      btnCopyEnc.addEventListener('click', ()=> {
        const text = encOutEl.textContent || '';
        if(!navigator.clipboard){ popup('FALHA AO COPIAR'); return; }
        navigator.clipboard.writeText(text)
          .then(()=> popup('TEXTO COPIADO'))
          .catch(()=> popup('FALHA AO COPIAR'));
      });
    }
  // --- FIN - BOTAO COPIAR SAIDA CRIPT (SEGURANCA: CHECA SE ELEMENTOS EXISTEM)

    document.getElementById('btnDecrypt').addEventListener('click', async ()=>{
      try {
        const data = (document.getElementById('cipherIn').value || '');
        if(!data){ popup_errado ('COLE A MENS CRIPTADA ABAIXO'); return; }
        if(!passDecEl.value){ popup_errado ('FALTOU A SENHA'); return; }
        const btn = document.getElementById('btnDecrypt');
        btn.disabled = true; btn.textContent = 'PROCESSANDO ...';
        const out = await decryptText(data, passDecEl.value);
        decOutEl.textContent = out;
        document.getElementById('btnCopyDec').disabled = false;
        document.getElementById('btnReEncrypt').disabled = false;
      } catch (err){
        console.error('ERRO DECRYPT', err);
        popup_errado ('FALHA AO DECRIPT - SENHA OU CONTEUDO INVALIDO');
      } finally {
        const btn = document.getElementById('btnDecrypt');
        btn.disabled = false; btn.textContent = 'DECRIPT';
      }
    });

    document.getElementById('btnCopyDec').addEventListener('click',()=>navigator.clipboard.writeText(decOutEl.textContent).then(()=>popup_certo ('TEXTO COPIADO'),()=>popup_errado ('FALHA AO COPIAR')));

    // BOTAO RE-ENCRYPT (SEGURANCA: CHECA decOutEl e passDecEl)
    const btnReEncrypt = document.getElementById('btnReEncrypt');

    if(btnReEncrypt){
      btnReEncrypt.addEventListener('click', async ()=>{
        try{
          const current = (decOutEl && decOutEl.textContent) || '';
          const newPw = (passDecEl && passDecEl.value) || '';
          if(!current){ popup('NAO HA TEXTO PRA RE-CRIPTAR'); return; }
          if(!newPw){ popup('FALTOU A SENHA'); return; }

          btnReEncrypt.disabled = true;
          btnReEncrypt.textContent = 'RE-CRIPTANDO ...';

          const newEnc = await encryptText(current, newPw);

          const cipherInEl = document.getElementById('cipherIn');
          if(cipherInEl) cipherInEl.value = newEnc;
          if(encOutEl) encOutEl.textContent = newEnc;

          const btnDownloadEnc = document.getElementById('btnDownloadEnc');
          const btnCopyEncLocal = document.getElementById('btnCopyEnc');
          if(btnDownloadEnc) btnDownloadEnc.disabled = false;
          if(btnCopyEncLocal) btnCopyEncLocal.disabled = false;

          popup('RE-CRIPTADO E COLOCADO NO CAMPO DE SAIDA');
        }catch(e){
          console.error('ERRO RE-ENCRYPT', e);
          popup('ERRO AO RE-CRIPTAR');
        }finally{
          btnReEncrypt.disabled = false;
          btnReEncrypt.textContent = 'RE-CRIPTAR';
        }
      });
    }

    document.addEventListener('keydown',e=>{
      if(
        (e.ctrlKey && ['c','u','s','p'].includes(e.key.toLowerCase()))
        || e.key === 'F12'
      ){
        e.preventDefault();
      }
    });

    function scrollAdjEnc(){
      const sec = document.getElementById('sec-enc-scroll');
      const top = sec.getBoundingClientRect().top + window.scrollY - 140;
      window.scrollTo({ top: top, behavior:'smooth' });
    }

    function scrollAdjDec(){
      const sec = document.getElementById('sec-dec-scroll');
      const top = sec.getBoundingClientRect().top + window.scrollY - 90;
      window.scrollTo({ top: top, behavior:'smooth' });
    }

    function clearAllFields(){

      const plain = document.getElementById('plain');
      const cipherOut = document.getElementById('cipherOut');
      const passEnc = document.getElementById('passEnc');

      const cipherIn = document.getElementById('cipherIn');
      const decOut = document.getElementById('decOut');
      const passDec = document.getElementById('passDec');

      if(plain) plain.value='';
      if(cipherOut) cipherOut.value='';
      if(passEnc) passEnc.value='';

      if(cipherIn) cipherIn.value='';
      if(decOut) decOut.value='';
      if(passDec) passDec.value='';

      popup_certo ('CAMPOS LIMPADOS');

    }

    /* JS - SUBSTITUA A FUNCAO popup_errado EXISTENTE POR ESTA VERSAO */
    /* OBS: GARANTE QUE O <div id="popup_msg_errado"></div> ESTEJA DIRETO NO <body> */
    function popup_errado(msg){
      const box = document.getElementById('popup_msg_errado');
      if(!box) return;

      // DEFINICOES INICIAIS; NAO DAR FOCUS NO BOX PARA EVITAR ROLAGEM
      box.innerText = msg;
      box.setAttribute('aria-hidden','false');
      box.style.display = 'block';
      box.style.opacity = '0';

      // FORCAR APARECIMENTO SUAVE SEM FOCUS
      requestAnimationFrame(()=>{ box.style.opacity = '1'; });

      // FECHAR AUTOMATICAMENTE APOS 2500ms
      const hideTimer = setTimeout(()=>{ 
        box.style.opacity = '0'; 
        setTimeout(()=>{ 
          box.style.display = 'none'; 
          box.setAttribute('aria-hidden','true');
        }, 240);
      }, 2500);

      // CLIQUE NO BOX FECHA IMEDIATAMENTE, SEM DAR FOCUS
      box.onclick = ()=>{
        clearTimeout(hideTimer);
        box.style.opacity = '0';
        setTimeout(()=>{ box.style.display='none'; box.setAttribute('aria-hidden','true'); }, 240);
      };
    }

    /* JS - SUBSTITUA A FUNCAO popup_errado EXISTENTE POR ESTA VERSAO */
    /* OBS: GARANTE QUE O <div id="popup_msg_errado"></div> ESTEJA DIRETO NO <body> */
    function popup_certo (msg){
      const box = document.getElementById('popup_msg_certo');
      if(!box) return;

      // DEFINICOES INICIAIS; NAO DAR FOCUS NO BOX PARA EVITAR ROLAGEM
      box.innerText = msg;
      box.setAttribute('aria-hidden','false');
      box.style.display = 'block';
      box.style.opacity = '0';

      // FORCAR APARECIMENTO SUAVE SEM FOCUS
      requestAnimationFrame(()=>{ box.style.opacity = '1'; });

      // FECHAR AUTOMATICAMENTE APOS 2500ms
      const hideTimer = setTimeout(()=>{ 
        box.style.opacity = '0'; 
        setTimeout(()=>{ 
          box.style.display = 'none'; 
          box.setAttribute('aria-hidden','true');
        }, 240);
      }, 2500);

      // CLIQUE NO BOX FECHA IMEDIATAMENTE, SEM DAR FOCUS
      box.onclick = ()=>{
        clearTimeout(hideTimer);
        box.style.opacity = '0';
        setTimeout(()=>{ box.style.display='none'; box.setAttribute('aria-hidden','true'); }, 240);
      };
    }

  </script>

</body>

</html>
